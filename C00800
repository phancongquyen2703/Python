https://learn.microsoft.com/en-us/sharepoint/dev/sp-add-ins/working-with-folders-and-files-with-rest

uri: _api/SP.MoveCopyUtil.MoveFolderByPath()
header: Accept: application/json;odata=verbose

{
    "srcPath": {
             "DecodedUrl": "https://fptsoftware362.sharepoint.com/sites/MyTeamPowerApps/Shared Documents/Database_test/1"
    },
    "destPath": {
       "DecodedUrl": "https://fptsoftware362.sharepoint.com/sites/MyTeamPowerApps/Shared Documents/Database_test/2/1"
    },
	"options": {
    "KeepBoth": false,
    "ResetAuthorAndCreatedOnCopy": false,
    "ShouldBypassSharedLocks": true
  }

}


Ráº¥t tá»‘t â€” thÃ´ng tin báº¡n Ä‘Æ°a lÃ  máº¥u chá»‘t quan trá»ng:

â¤ Báº¡n Ä‘Ã£ thÃªm "KeepBoth": false nhÆ°ng váº«n lá»—i
â¤ Lá»—i: The destination file already exists.

ğŸ“ Äiá»u nÃ y cho tháº¥y:

API SP.MoveCopyUtil.MoveFolderByPath khÃ´ng thá»±c sá»± ghi Ä‘Ã¨ náº¿u thÆ° má»¥c Ä‘Ã­ch Ä‘Ã£ tá»“n táº¡i.

KeepBoth=false khÃ´ng cÃ³ nghÄ©a lÃ  overwrite, nÃ³ chá»‰ táº¯t tÃ­nh nÄƒng táº¡o báº£n copy má»›i náº¿u Ä‘Ã­ch chÆ°a tá»“n táº¡i â†’ nhÆ°ng náº¿u Ä‘Ã£ tá»“n táº¡i, SharePoint sáº½ bÃ¡o lá»—i vÃ  dá»«ng.

ğŸ”¹ NÃ³i cÃ¡ch khÃ¡c: MoveFolderByPath khÃ´ng thá»ƒ overwrite â†’ báº¡n pháº£i xÃ³a thÆ° má»¥c Ä‘Ã­ch trÆ°á»›c khi di chuyá»ƒn.

âœ… Giáº£i phÃ¡p Ä‘Ãºng: XÃ³a thÆ° má»¥c Ä‘Ã­ch náº¿u Ä‘Ã£ tá»“n táº¡i â†’ sau Ä‘Ã³ má»›i Move
BÆ°á»›c 1 â€” Kiá»ƒm tra thÆ° má»¥c Ä‘Ã­ch cÃ³ tá»“n táº¡i khÃ´ng
GET https://<tenant>.sharepoint.com/sites/<site>/_api/web/getfolderbyserverrelativeurl('/sites/<site>/Shared Documents/TargetFolder/SourceFolder')


Náº¿u tráº£ vá» 200 â†’ folder tá»“n táº¡i

Náº¿u tráº£ vá» 404 â†’ chÆ°a tá»“n táº¡i

BÆ°á»›c 2 â€” Náº¿u cÃ³, xÃ³a thÆ° má»¥c Ä‘Ã­ch
POST https://<tenant>.sharepoint.com/sites/<site>/_api/web/getfolderbyserverrelativeurl('/sites/<site>/Shared Documents/TargetFolder/SourceFolder')


Headers

X-HTTP-Method: DELETE
IF-MATCH: *

BÆ°á»›c 3 â€” Gá»i MoveFolderByPath nhÆ° báº¡n Ä‘ang lÃ m
POST https://<tenant>.sharepoint.com/sites/<site>/_api/SP.MoveCopyUtil.MoveFolderByPath()


Body

{
  "srcPath": {
    "DecodedUrl": "https://<tenant>.sharepoint.com/sites/<site>/Shared Documents/SourceFolder"
  },
  "destPath": {
    "DecodedUrl": "https://<tenant>.sharepoint.com/sites/<site>/Shared Documents/TargetFolder/SourceFolder"
  },
  "options": {
    "KeepBoth": false,
    "ResetAuthorAndCreatedOnCopy": false,
    "ShouldBypassSharedLocks": true
  }
}
******************************************
âš¡ TÃ³m gá»n
Váº¥n Ä‘á»	Thá»±c táº¿
KeepBoth=false	âŒ KhÃ´ng overwrite náº¿u Ä‘Ã­ch Ä‘Ã£ tá»“n táº¡i
Muá»‘n overwrite	âœ… Pháº£i xÃ³a thÆ° má»¥c Ä‘Ã­ch trÆ°á»›c, rá»“i má»›i gá»i MoveFolderByPath

ğŸ’¬ Náº¿u báº¡n muá»‘n, mÃ¬nh cÃ³ thá»ƒ viáº¿t luÃ´n flow 3 bÆ°á»›c (Check â†’ Delete â†’ Move) dáº¡ng REST API máº«u Ä‘á»ƒ báº¡n chá»‰ cáº§n copy vÃ o Power Automate Desktop (Invoke Web Service).

Báº¡n cÃ³ muá»‘n mÃ¬nh táº¡o sáºµn máº«u Ä‘Ã³ khÃ´ng? (sáº½ giáº£i quyáº¿t triá»‡t Ä‘á»ƒ lá»—i The destination file already exists.)

- Create Folder: 

URL: _api/web/folders
Method: Post
Body: {
  "__metadata": { "type": "SP.Folder" },
  "ServerRelativeUrl": "/sites/MyTeamPowerApps/Shared Documents/NewFolderDemo"
}
Header: {
  "__metadata": { "type": "SP.Folder" },
  "ServerRelativeUrl": "/sites/MyTeamPowerApps/Shared Documents/NewFolderDemo"
}

