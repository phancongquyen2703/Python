Ã€ ğŸ‘ báº¡n Ä‘ang Ä‘á»¥ng Ä‘Ãºng chá»— hÆ¡i â€œkhÃ³ chá»‹uâ€ cá»§a Google Drive API:
máº·c Ä‘á»‹nh API chá»‰ thao tÃ¡c vá»›i My Drive cÃ¡ nhÃ¢n, náº¿u khÃ´ng báº­t tham sá»‘ Ä‘áº·c biá»‡t thÃ¬ nÃ³ sáº½ bá» qua Shared Drive (Drive chung).

ğŸš¨ NguyÃªn nhÃ¢n báº¡n khÃ´ng tháº¥y Shared Drive

Báº¡n gá»i API files.list hoáº·c files.create nhÆ°ng chÆ°a thÃªm tham sá»‘:

supportsAllDrives=true

includeItemsFromAllDrives=true (khi list file)

driveId=<ID cá»§a shared drive> (khi lÃ m viá»‡c trong Shared Drive)

Náº¿u khÃ´ng cÃ³ â†’ Google Drive API chá»‰ tráº£ vá» My Drive.

âœ… CÃ¡ch fix (vÃ­ dá»¥ cá»¥ thá»ƒ)
1. Táº¡o folder trong Shared Drive

Endpoint:

POST https://www.googleapis.com/drive/v3/files?supportsAllDrives=true


Headers:

Authorization: Bearer <ACCESS_TOKEN>
Content-Type: application/json


Body JSON (vÃ­ dá»¥ táº¡o folder trong Shared Drive cÃ³ driveId = 0AJxxxxxx):

{
  "name": "TestFolder",
  "mimeType": "application/vnd.google-apps.folder",
  "parents": ["0AJxxxxxx"]   // chÃ­nh lÃ  ID cá»§a Shared Drive
}

2. Láº¥y danh sÃ¡ch file trong Shared Drive
GET https://www.googleapis.com/drive/v3/files?driveId=0AJxxxxxx&includeItemsFromAllDrives=true&supportsAllDrives=true&corpora=drive&fields=files(id,name,mimeType)


driveId=0AJxxxxxx â†’ ID cá»§a Shared Drive

corpora=drive â†’ buá»™c API láº¥y trong Shared Drive Ä‘Ã³ (chá»© khÃ´ng pháº£i My Drive)

supportsAllDrives=true â†’ báº­t cháº¿ Ä‘á»™ cho Shared Drive

includeItemsFromAllDrives=true â†’ láº¥y cáº£ ná»™i dung cá»§a Shared Drive

3. Quyá»n truy cáº­p

Token cá»§a báº¡n pháº£i cÃ³ scope:

https://www.googleapis.com/auth/drive (full access)

hoáº·c Ã­t nháº¥t https://www.googleapis.com/auth/drive.file (file báº¡n táº¡o/Ä‘Æ°á»£c chia sáº»).

TÃ i khoáº£n dÃ¹ng OAuth pháº£i cÃ³ quyá»n trong Shared Drive (VD: Member, Contributor, Manager).

ğŸš€ TÃ­ch há»£p trong PAD

Khi báº¡n dÃ¹ng Invoke Web Service:

URL pháº£i cÃ³ supportsAllDrives=true

Khi táº¡o folder, trong body dÃ¹ng "parents": ["<SharedDriveId>"] thay vÃ¬ "root".

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t cho báº¡n PAD máº«u .txt import chá»‰ Ä‘á»ƒ táº¡o folder trong Shared Drive (cÃ³ tham sá»‘ supportsAllDrives + driveId) khÃ´ng?

You said:
HÆ°á»›ng dáº«n mÃ¬nh kiá»ƒm tra folder Ä‘Ã£ tá»“n táº¡i trong Share Drive luÃ´n nhÃ©
ChatGPT said:

Rá»“i ğŸ‘ mÃ¬nh sáº½ hÆ°á»›ng dáº«n báº¡n cÃ¡ch kiá»ƒm tra má»™t folder Ä‘Ã£ tá»“n táº¡i trong Shared Drive báº±ng Google Drive API, Ã¡p dá»¥ng cho cáº£ Power Automate Desktop (PAD).

ğŸ“Œ 1. Ã tÆ°á»Ÿng

Thay vÃ¬ táº¡o folder tháº³ng, ta dÃ¹ng files.list API Ä‘á»ƒ tÃ¬m folder theo name vÃ  parent trong Shared Drive.

Náº¿u cÃ³ káº¿t quáº£ â†’ folder Ä‘Ã£ tá»“n táº¡i.

Náº¿u khÃ´ng cÃ³ káº¿t quáº£ â†’ folder chÆ°a cÃ³ â†’ báº¡n cÃ³ thá»ƒ táº¡o má»›i.

ğŸ“Œ 2. API Request
ğŸ”¹ Endpoint
GET https://www.googleapis.com/drive/v3/files?q=name='Invoices' and mimeType='application/vnd.google-apps.folder' and '0AJxxxxxx' in parents and trashed=false&driveId=0AJxxxxxx&includeItemsFromAllDrives=true&supportsAllDrives=true&corpora=drive&fields=files(id,name)

ğŸ”¹ Giáº£i thÃ­ch

q=... â†’ filter:

name='Invoices' â†’ tÃªn folder cáº§n tÃ¬m.

mimeType='application/vnd.google-apps.folder' â†’ chá»‰ láº¥y folder.

'0AJxxxxxx' in parents â†’ folder cha chÃ­nh lÃ  Shared Drive ID hoáº·c folder con trong Shared Drive.

trashed=false â†’ bá» qua file Ä‘Ã£ xÃ³a.

driveId=0AJxxxxxx â†’ ID cá»§a Shared Drive.

includeItemsFromAllDrives=true â†’ cho phÃ©p tÃ¬m cáº£ trong Shared Drive.

supportsAllDrives=true â†’ báº­t cháº¿ Ä‘á»™ há»— trá»£ Shared Drive.

corpora=drive â†’ chá»‰ tÃ¬m trong Shared Drive nÃ y.

fields=files(id,name) â†’ chá»‰ láº¥y id vÃ  tÃªn (Ä‘á»¡ náº·ng).

ğŸ“Œ 3. Káº¿t quáº£ tráº£ vá»

Náº¿u folder Ä‘Ã£ tá»“n táº¡i:

{
  "files": [
    {
      "id": "1AbCDefGhijkLMNOPqrSTuvWxYZ",
      "name": "Invoices"
    }
  ]
}


Náº¿u folder chÆ°a tá»“n táº¡i:

{
  "files": []
}

ğŸ“Œ 4. Ãp dá»¥ng trong PAD

Invoke Web Service

Method: GET

URL: copy endpoint á»Ÿ trÃªn, thay Invoices báº±ng biáº¿n %FolderName% vÃ  0AJxxxxxx báº±ng %SharedDriveId%.

Header:

Authorization: Bearer %AccessToken%

Parse JSON (dÃ¹ng action Convert JSON to custom object)

Input: %ResponseContent%

If condition

Náº¿u %ResponseObject["files"]% cÃ³ item â†’ folder tá»“n táº¡i (láº¥y id).

Náº¿u rá»—ng â†’ gá»i API files.create Ä‘á»ƒ táº¡o folder má»›i.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t háº³n má»™t flow PAD máº«u .txt import:

Input: %AccessToken%, %FolderName%, %SharedDriveId%

Output: %FolderId% (id folder Ä‘Ã£ tá»“n táº¡i hoáº·c vá»«a táº¡o)
Ä‘á»ƒ báº¡n chá»‰ cáº§n import vÃ o PAD cháº¡y luÃ´n khÃ´ng?
