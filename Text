https://drive.google.com/drive/folders/1NRPV2h3f1Pcm2ULd59YTqFlvLcGy4HEn?usp=sharing

----------------------------------------------------------------------------------------------------------------------------------
Attribute VB_Name = "Module2"
Sub CreatePivot()
    Dim wsData As Worksheet
    Dim wsPivot As Worksheet
    Dim pc As PivotCache
    Dim pt As PivotTable
    Dim rng As Range
    
    ' Set data sheet
    Set wsData = ThisWorkbook.Sheets("Data")
    
    ' Define data range (dynamic last row)
    Set rng = wsData.Range("A1").CurrentRegion
    
    ' Delete old Pivot sheet if exists
    On Error Resume Next
    Application.DisplayAlerts = False
    ThisWorkbook.Sheets("Pivot").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' Add new Pivot sheet
    Set wsPivot = ThisWorkbook.Sheets.Add
    wsPivot.Name = "Pivot"
    
    ' Create Pivot Cache
    Set pc = ThisWorkbook.PivotCaches.Create( _
        SourceType:=xlDatabase, _
        SourceData:=rng.Address(True, True, xlR1C1, True))
    
    ' Create Pivot Table
    Set pt = pc.CreatePivotTable( _
        TableDestination:=wsPivot.Range("A3"), _
        TableName:="SalesPivot")
    
    ' Add Fields
    With pt
        .PivotFields("Region").Orientation = xlRowField
        .PivotFields("Product").Orientation = xlColumnField
        .AddDataField .PivotFields("Sales"), "Sum of Sales", xlSum
        .PivotFields("Date").Orientation = xlPageField
    End With
    
End Sub


--------------------------------------------------------------------------------------------------------------------------------

3. C√°ch ch·∫°y b·∫±ng UiPath

Trong UiPath Studio, b·∫°n l√†m nh∆∞ sau:

Use Excel Application Scope

Input: PivotTemplate.xlsm

Invoke VBA activity

Path: ch·ªçn file .bas n·∫øu export code (ho·∫∑c copy code VBA v√†o Editor).

EntryMethodName: "CreatePivot"

Save Workbook (n·∫øu c·∫ßn).

üëâ C√°ch ƒë∆°n gi·∫£n h∆°n:

Trong Excel Application Scope, d√πng Execute Macro activity.

G√µ t√™n macro: CreatePivot.

-----------------------------------


‚ö†Ô∏è L∆∞u √Ω:

File ph·∫£i l√† .xlsm v√† Macro ƒë√£ ƒë∆∞·ª£c b·∫≠t (Enable Macros).

N·∫øu Macro n·∫±m trong Module th√¨ ch·ªâ c·∫ßn g·ªçi ƒë√∫ng t√™n Sub (CreatePivot).

N·∫øu b·ªã ch·∫∑n b·ªüi security Excel, c·∫ßn b·∫≠t Trust access to VBA project object model trong Excel Options ‚Üí Trust Center



