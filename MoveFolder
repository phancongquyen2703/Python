Move Folder
ğŸ“Œ CÃ¡c bÆ°á»›c thá»±c hiá»‡n trong PAD
ğŸ… BÆ°á»›c 1 â€” Gá»i Azure AD láº¥y Access Token

HTTP POST

https://accounts.accesscontrol.windows.net/<tenant-id>/tokens/OAuth/2


Body (x-www-form-urlencoded):

grant_type=client_credentials
&client_id=<appId>@<tenantId>
&client_secret=<secret>
&resource=00000003-0000-0ff1-ce00-000000000000/<tenant>.sharepoint.com@<tenantId>


Nháº­n vá»: access_token

ğŸ…‘ BÆ°á»›c 2 â€” Láº¥y RequestDigest

HTTP POST

https://<tenant>.sharepoint.com/sites/<site>/_api/contextinfo


Headers

Authorization: Bearer <access_token>
Accept: application/json;odata=verbose


Káº¿t quáº£: trong d.GetContextWebInformation.FormDigestValue

ğŸ…’ BÆ°á»›c 3 â€” Gá»i MoveFolderByPath

POST

https://<tenant>.sharepoint.com/sites/<site>/_api/SP.MoveCopyUtil.MoveFolderByPath()


Headers

{
  "Accept": "application/json;odata=verbose",
  "Content-Type": "application/json;odata=verbose",
  "Authorization": "Bearer <access_token>",
  "X-RequestDigest": "<FormDigestValue>"
}


Body

{
  "srcPath": { "DecodedUrl": "/sites/<site>/Shared Documents/OldFolder" },
  "destPath": { "DecodedUrl": "/sites/<site>/Shared Documents/NewFolder/OldFolder" },
  "options": { "KeepBoth": false, "ResetAuthorAndCreatedOnCopy": true }
}


âœ… LÃºc nÃ y SharePoint má»›i thá»±c sá»± thá»±c hiá»‡n viá»‡c di chuyá»ƒn.

ğŸ“Œ TÃ³m gá»n

Trong PAD, báº¡n pháº£i tá»± cáº¥p token + digest â†’ náº¿u khÃ´ng, SharePoint tráº£ vá» null vÃ  khÃ´ng move dÃ¹ bÃ¡o 200

Trong Cloud, há»‡ thá»‘ng lÃ m giÃºp báº¡n

ğŸ“¦ Náº¿u báº¡n muá»‘n, mÃ¬nh cÃ³ thá»ƒ viáº¿t sáºµn file .json Flow máº«u cho Power Automate Desktop gá»“m:

BÆ°á»›c láº¥y token

BÆ°á»›c láº¥y digest

BÆ°á»›c gá»i MoveFolderByPath

Báº¡n cÃ³ muá»‘n mÃ¬nh táº¡o máº«u Ä‘Ã³ khÃ´ng? (copy vÃ o PAD lÃ  cháº¡y Ä‘Æ°á»£c luÃ´n)


âœ… Giáº£i phÃ¡p thay tháº¿ hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh

Thay vÃ¬ MoveFolderByPath(), hÃ£y dÃ¹ng chuá»—i 2 REST API: Copy + Delete. ÄÃ¢y lÃ  cÃ¡ch phá»• biáº¿n Ä‘Æ°á»£c Microsoft chÃ­nh thá»©c khuyáº¿n nghá»‹ khi khÃ´ng dÃ¹ng CSOM:

ğŸ“ BÆ°á»›c 1 â€” Copy thÆ° má»¥c

POST

https://<tenant>.sharepoint.com/sites/<site>/_api/SP.MoveCopyUtil.CopyFolderByPath()


Headers

{
  "Accept": "application/json;odata=verbose",
  "Content-Type": "application/json;odata=verbose",
  "Authorization": "Bearer <access_token>",
  "X-RequestDigest": "<FormDigestValue>"
}


Body

{
  "srcPath": { "DecodedUrl": "/sites/<site>/Shared Documents/OldFolder" },
  "destPath": { "DecodedUrl": "/sites/<site>/Shared Documents/NewParent/OldFolder" },
  "options": { "KeepBoth": false, "ResetAuthorAndCreatedOnCopy": true }
}


ğŸ“Œ Äá»£i khi copy xong má»›i qua bÆ°á»›c xÃ³a.

ğŸ“ BÆ°á»›c 2 â€” Delete thÆ° má»¥c gá»‘c

POST (vÃ¬ DELETE khÃ´ng Ä‘Æ°á»£c há»— trá»£ trá»±c tiáº¿p qua PAD invoke)

https://<tenant>.sharepoint.com/sites/<site>/_api/web/GetFolderByServerRelativeUrl('/sites/<site>/Shared Documents/OldFolder')


Headers

{
  "X-RequestDigest": "<FormDigestValue>",
  "IF-MATCH": "*",
  "X-HTTP-Method": "DELETE",
  "Authorization": "Bearer <access_token>"
}


ğŸ“Œ ÄÃ¢y lÃ  "trick" gá»i DELETE trong PAD: dÃ¹ng POST + header X-HTTP-Method: DELETE.
