Skip to content
Chat history

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ get list file in folder Gdrive báº±ng API power automate desktop
ChatGPT said:
Báº¡n muá»‘n láº¥y danh sÃ¡ch file trong 1 folder cá»§a Google Drive báº±ng Power Automate Desktop (PAD) thÃ´ng qua Google Drive API Ä‘Ãºng khÃ´ng? ğŸ‘

MÃ¬nh hÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c nhÃ©:

ğŸ”‘ 1. Chuáº©n bá»‹ trÆ°á»›c
Báº¡n cáº§n Access Token (tá»« OAuth2 hoáº·c Service Account) vá»›i scope:

https://www.googleapis.com/auth/drive
LÆ°u Folder ID cá»§a thÆ° má»¥c báº¡n muá»‘n láº¥y file.
VÃ­ dá»¥ URL folder:

https://drive.google.com/drive/folders/1ABCDefGHIJKLmnop
ğŸ‘‰ Folder ID = 1ABCDefGHIJKLmnop

ğŸ“¡ 2. API Google Drive Ä‘á»ƒ láº¥y danh sÃ¡ch file
Endpoint:

GET https://www.googleapis.com/drive/v3/files
Query Ä‘á»ƒ lá»c theo folder:

?q='<FolderID>' in parents and trashed=false
VÃ­ dá»¥ Ä‘áº§y Ä‘á»§:

GET https://www.googleapis.com/drive/v3/files?q='1ABCDefGHIJKLmnop' in parents and trashed=false&fields=files(id,name,mimeType)
Header:

{
  "Authorization": "Bearer <ACCESS_TOKEN>"
}
âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service (hoáº·c Invoke Web Request).

Method: GET

URL:

https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&fields=files(id,name,mimeType)
Headers:

Authorization: Bearer %Access_Token%
Nháº­n Response JSON â†’ parse ra danh sÃ¡ch file:
VÃ­ dá»¥ response:

{
  "files": [
    { "id": "1x2y3z", "name": "file1.pdf", "mimeType": "application/pdf" },
    { "id": "4a5b6c", "name": "file2.docx", "mimeType": "application/vnd.openxmlformats-officedocument.wordprocessingml.document" }
  ]
}
Parse JSON trong PAD:

DÃ¹ng action: Convert JSON to custom object

Sau Ä‘Ã³ cÃ³ thá»ƒ For Each Ä‘á»ƒ duyá»‡t danh sÃ¡ch file.

ğŸ“Œ 4. Láº¥y cáº£ subfolder?
API máº·c Ä‘á»‹nh chá»‰ tráº£ file trong folder trá»±c tiáº¿p.

Náº¿u muá»‘n láº¥y táº¥t cáº£ subfolder + file bÃªn trong â†’ báº¡n pháº£i cháº¡y Ä‘á»‡ quy:

Gá»i API láº¥y list files cÃ³ mimeType = 'application/vnd.google-apps.folder'.

Sau Ä‘Ã³ láº·p qua tá»«ng folder con Ä‘á»ƒ gá»i láº¡i API.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t máº«u flow PAD (gá»“m HTTP request + Parse JSON + Loop) Ä‘á»ƒ láº¥y danh sÃ¡ch file trong folder khÃ´ng?

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ move file hoáº·c folder trong Gdrive báº±ng power automate desktop
ChatGPT said:
Äá»ƒ move file hoáº·c folder trong Google Drive báº±ng Power Automate Desktop (PAD) thÃ¬ báº¡n sáº½ thao tÃ¡c vá»›i Google Drive API. Báº£n cháº¥t â€œmoveâ€ trong GDrive lÃ  thay Ä‘á»•i parents cá»§a file/folder (remove old parent, add new parent).

ğŸ”‘ 1. Chuáº©n bá»‹
Access Token (OAuth2) vá»›i scope:

https://www.googleapis.com/auth/drive
ID cá»§a file/folder cáº§n move (vÃ­ dá»¥: 1ABCxyz...).

ID cá»§a folder Ä‘Ã­ch (vÃ­ dá»¥: 1Target123...).

ID cá»§a folder gá»‘c (old parent) náº¿u báº¡n muá»‘n bá» nÃ³ khá»i thÆ° má»¥c cÅ©.

ğŸ“¡ 2. API Move file/folder
Google Drive API endpoint:

PATCH https://www.googleapis.com/drive/v3/files/{fileId}?addParents={newParentId}&removeParents={oldParentId}&fields=id,parents
VÃ­ dá»¥
Move file 1ABCxyz tá»« folder 1OLD111 sang folder 1NEW222:

PATCH https://www.googleapis.com/drive/v3/files/1ABCxyz?addParents=1NEW222&removeParents=1OLD111&fields=id,parents
Header:

Authorization: Bearer <ACCESS_TOKEN>
Content-Type: application/json
Body: (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng vÃ¬ chá»‰ cáº§n query params)

âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service

Method: PATCH

URL:

https://www.googleapis.com/drive/v3/files/%FileID%?addParents=%NewFolderID%&removeParents=%OldFolderID%&fields=id,parents
Headers:

Authorization: Bearer %Access_Token%
Content-Type: application/json
Body: {} (hoáº·c Ä‘á»ƒ trá»‘ng)

Xá»­ lÃ½ Response

Náº¿u thÃ nh cÃ´ng, JSON tráº£ vá» sáº½ chá»©a id vÃ  parents má»›i.

Báº¡n cÃ³ thá»ƒ dÃ¹ng Convert JSON to custom object Ä‘á»ƒ parse.

ğŸ“Œ 4. Move Folder
Google Drive treats folders cÅ©ng nhÆ° file (mimeType = application/vnd.google-apps.folder).

VÃ¬ váº­y move folder cÅ©ng dÃ¹ng API trÃªn giá»‘ng há»‡t nhÆ° move file. âœ…

ğŸ” 5. LÆ°u Ã½
Náº¿u báº¡n khÃ´ng truyá»n removeParents, file sáº½ náº±m á»Ÿ cáº£ hai folder (Google Drive cho phÃ©p 1 file cÃ³ nhiá»u parents).

Náº¿u muá»‘n chá»‰ á»Ÿ 1 folder duy nháº¥t â†’ luÃ´n truyá»n cáº£ addParents vÃ  removeParents.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n máº«u action trong PAD (Invoke Web Service) Ä‘á»ƒ báº¡n copy-paste vÃ o flow, chá»‰ cáº§n thay ID vÃ  Token khÃ´ng?






KhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»nKhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»n
ChatGPT can make mistakes. Check important info.


GET https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&driveId=<DriveID>&corpora=drive&includeItemsFromAllDrives=true&supportsAllDrives=true&fields=files(id,name,mimeType,parents)
Skip to content
Chat history

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ get list file in folder Gdrive báº±ng API power automate desktop
ChatGPT said:
Báº¡n muá»‘n láº¥y danh sÃ¡ch file trong 1 folder cá»§a Google Drive báº±ng Power Automate Desktop (PAD) thÃ´ng qua Google Drive API Ä‘Ãºng khÃ´ng? ğŸ‘

MÃ¬nh hÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c nhÃ©:

ğŸ”‘ 1. Chuáº©n bá»‹ trÆ°á»›c
Báº¡n cáº§n Access Token (tá»« OAuth2 hoáº·c Service Account) vá»›i scope:

https://www.googleapis.com/auth/drive
LÆ°u Folder ID cá»§a thÆ° má»¥c báº¡n muá»‘n láº¥y file.
VÃ­ dá»¥ URL folder:

https://drive.google.com/drive/folders/1ABCDefGHIJKLmnop
ğŸ‘‰ Folder ID = 1ABCDefGHIJKLmnop

ğŸ“¡ 2. API Google Drive Ä‘á»ƒ láº¥y danh sÃ¡ch file
Endpoint:

GET https://www.googleapis.com/drive/v3/files
Query Ä‘á»ƒ lá»c theo folder:

?q='<FolderID>' in parents and trashed=false
VÃ­ dá»¥ Ä‘áº§y Ä‘á»§:

GET https://www.googleapis.com/drive/v3/files?q='1ABCDefGHIJKLmnop' in parents and trashed=false&fields=files(id,name,mimeType)
Header:

{
  "Authorization": "Bearer <ACCESS_TOKEN>"
}
âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service (hoáº·c Invoke Web Request).

Method: GET

URL:

https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&fields=files(id,name,mimeType)
Headers:

Authorization: Bearer %Access_Token%
Nháº­n Response JSON â†’ parse ra danh sÃ¡ch file:
VÃ­ dá»¥ response:

{
  "files": [
    { "id": "1x2y3z", "name": "file1.pdf", "mimeType": "application/pdf" },
    { "id": "4a5b6c", "name": "file2.docx", "mimeType": "application/vnd.openxmlformats-officedocument.wordprocessingml.document" }
  ]
}
Parse JSON trong PAD:

DÃ¹ng action: Convert JSON to custom object

Sau Ä‘Ã³ cÃ³ thá»ƒ For Each Ä‘á»ƒ duyá»‡t danh sÃ¡ch file.

ğŸ“Œ 4. Láº¥y cáº£ subfolder?
API máº·c Ä‘á»‹nh chá»‰ tráº£ file trong folder trá»±c tiáº¿p.

Náº¿u muá»‘n láº¥y táº¥t cáº£ subfolder + file bÃªn trong â†’ báº¡n pháº£i cháº¡y Ä‘á»‡ quy:

Gá»i API láº¥y list files cÃ³ mimeType = 'application/vnd.google-apps.folder'.

Sau Ä‘Ã³ láº·p qua tá»«ng folder con Ä‘á»ƒ gá»i láº¡i API.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t máº«u flow PAD (gá»“m HTTP request + Parse JSON + Loop) Ä‘á»ƒ láº¥y danh sÃ¡ch file trong folder khÃ´ng?

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ move file hoáº·c folder trong Gdrive báº±ng power automate desktop
ChatGPT said:
Äá»ƒ move file hoáº·c folder trong Google Drive báº±ng Power Automate Desktop (PAD) thÃ¬ báº¡n sáº½ thao tÃ¡c vá»›i Google Drive API. Báº£n cháº¥t â€œmoveâ€ trong GDrive lÃ  thay Ä‘á»•i parents cá»§a file/folder (remove old parent, add new parent).

ğŸ”‘ 1. Chuáº©n bá»‹
Access Token (OAuth2) vá»›i scope:

https://www.googleapis.com/auth/drive
ID cá»§a file/folder cáº§n move (vÃ­ dá»¥: 1ABCxyz...).

ID cá»§a folder Ä‘Ã­ch (vÃ­ dá»¥: 1Target123...).

ID cá»§a folder gá»‘c (old parent) náº¿u báº¡n muá»‘n bá» nÃ³ khá»i thÆ° má»¥c cÅ©.

ğŸ“¡ 2. API Move file/folder
Google Drive API endpoint:

PATCH https://www.googleapis.com/drive/v3/files/{fileId}?addParents={newParentId}&removeParents={oldParentId}&fields=id,parents
VÃ­ dá»¥
Move file 1ABCxyz tá»« folder 1OLD111 sang folder 1NEW222:

PATCH https://www.googleapis.com/drive/v3/files/1ABCxyz?addParents=1NEW222&removeParents=1OLD111&fields=id,parents
Header:

Authorization: Bearer <ACCESS_TOKEN>
Content-Type: application/json
Body: (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng vÃ¬ chá»‰ cáº§n query params)

âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service

Method: PATCH

URL:

https://www.googleapis.com/drive/v3/files/%FileID%?addParents=%NewFolderID%&removeParents=%OldFolderID%&fields=id,parents
Headers:

Authorization: Bearer %Access_Token%
Content-Type: application/json
Body: {} (hoáº·c Ä‘á»ƒ trá»‘ng)

Xá»­ lÃ½ Response

Náº¿u thÃ nh cÃ´ng, JSON tráº£ vá» sáº½ chá»©a id vÃ  parents má»›i.

Báº¡n cÃ³ thá»ƒ dÃ¹ng Convert JSON to custom object Ä‘á»ƒ parse.

ğŸ“Œ 4. Move Folder
Google Drive treats folders cÅ©ng nhÆ° file (mimeType = application/vnd.google-apps.folder).

VÃ¬ váº­y move folder cÅ©ng dÃ¹ng API trÃªn giá»‘ng há»‡t nhÆ° move file. âœ…

ğŸ” 5. LÆ°u Ã½
Náº¿u báº¡n khÃ´ng truyá»n removeParents, file sáº½ náº±m á»Ÿ cáº£ hai folder (Google Drive cho phÃ©p 1 file cÃ³ nhiá»u parents).

Náº¿u muá»‘n chá»‰ á»Ÿ 1 folder duy nháº¥t â†’ luÃ´n truyá»n cáº£ addParents vÃ  removeParents.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n máº«u action trong PAD (Invoke Web Service) Ä‘á»ƒ báº¡n copy-paste vÃ o flow, chá»‰ cáº§n thay ID vÃ  Token khÃ´ng?

You said:
TÃ´i muá»‘n tÃ¬m trong ShareDrive
ChatGPT said:
Ã€ ğŸ‘ mÃ¬nh hiá»ƒu rá»“i: báº¡n muá»‘n move file hoáº·c folder trong Shared Drive (Google Shared Drive) báº±ng Power Automate Desktop.

Trong Google Drive API, thao tÃ¡c vá»›i My Drive vÃ  Shared Drive (Team Drive) gáº§n nhÆ° giá»‘ng nhau, chá»‰ khÃ¡c vÃ i tham sá»‘.

ğŸ”‘ 1. Äiá»ƒm khÃ¡c biá»‡t khi lÃ m vá»›i Shared Drive
File/Folder trong Shared Drive cÅ©ng cÃ³ id riÃªng (giá»‘ng My Drive).

NhÆ°ng khi báº¡n gá»i API, báº¡n cáº§n thÃªm tham sá»‘:

supportsAllDrives=true
Náº¿u list file trong Shared Drive â†’ thÃªm:

includeItemsFromAllDrives=true
corpora=drive
driveId=<SharedDriveID>
ğŸ“¡ 2. API Move file/folder trong Shared Drive
Giá»‘ng My Drive, chá»‰ thÃªm supportsAllDrives=true.

PATCH https://www.googleapis.com/drive/v3/files/{fileId}?addParents={newParentId}&removeParents={oldParentId}&supportsAllDrives=true&fields=id,parents
VÃ­ dá»¥
Move file 1FILE_ABC tá»« folder 1OLDFOLDER sang folder 1NEWFOLDER trong Shared Drive:

PATCH https://www.googleapis.com/drive/v3/files/1FILE_ABC?addParents=1NEWFOLDER&removeParents=1OLDFOLDER&supportsAllDrives=true&fields=id,parents
Header:

Authorization: Bearer <ACCESS_TOKEN>
Content-Type: application/json
Body: {} (hoáº·c trá»‘ng)

âš™ï¸ 3. Thá»±c hiá»‡n trong Power Automate Desktop
Action: Invoke Web Service

Method: PATCH

URL:

https://www.googleapis.com/drive/v3/files/%FileID%?addParents=%NewFolderID%&removeParents=%OldFolderID%&supportsAllDrives=true&fields=id,parents
Headers:

Authorization: Bearer %Access_Token%
Content-Type: application/json
Body: {}

Response tráº£ vá»:

{
  "id": "1FILE_ABC",
  "parents": ["1NEWFOLDER"]
}
ğŸ“Œ 4. LÆ°u Ã½ khi move trong Shared Drive
File/folder pháº£i thuá»™c cÃ¹ng Shared Drive má»›i move Ä‘Æ°á»£c (khÃ´ng move cross-drive Ä‘Æ°á»£c báº±ng cÃ¡ch Ä‘á»•i parent).

Náº¿u báº¡n cáº§n move giá»¯a Shared Drive khÃ¡c nhau â†’ pháº£i copy file sang drive má»›i rá»“i xÃ³a file cÅ©.

Account/service account dÃ¹ng token pháº£i cÃ³ quyá»n "Content manager" hoáº·c cao hÆ¡n trong Shared Drive.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n 2 flow máº«u cho PAD:

Move trong cÃ¹ng Shared Drive (Ä‘á»•i parent).

Move sang Shared Drive khÃ¡c (copy + delete)?

You said:
TÃ´i muá»‘n get file tá»« shareDrive
ChatGPT said:
Ok ğŸ‘ Ä‘á»ƒ get danh sÃ¡ch file trong Shared Drive (Google Drive â€“ Shared Drive) báº±ng Power Automate Desktop (PAD) qua API, báº¡n lÃ m nhÆ° sau:

ğŸ”‘ 1. Chuáº©n bá»‹
Access Token cÃ³ scope:

https://www.googleapis.com/auth/drive
ID cá»§a Shared Drive (driveId).
Báº¡n cÃ³ thá»ƒ láº¥y ID nÃ y trong URL khi má»Ÿ Shared Drive:

https://drive.google.com/drive/u/0/folders/0AAbCdEfGhIJkLmNOp
ğŸ‘‰ driveId = 0AAbCdEfGhIJkLmNOp

(TÃ¹y chá»n) Folder ID trong Shared Drive náº¿u báº¡n chá»‰ muá»‘n láº¥y file trong má»™t folder cá»¥ thá»ƒ.

ğŸ“¡ 2. API láº¥y file tá»« Shared Drive
ğŸ“ Láº¥y táº¥t cáº£ file trong Shared Drive
GET https://www.googleapis.com/drive/v3/files?corpora=drive&driveId=<DriveID>&includeItemsFromAllDrives=true&supportsAllDrives=true&q=trashed=false&fields=files(id,name,mimeType,parents)
ğŸ“ Láº¥y file trong má»™t folder cá»¥ thá»ƒ cá»§a Shared Drive
GET https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&driveId=<DriveID>&corpora=drive&includeItemsFromAllDrives=true&supportsAllDrives=true&fields=files(id,name,mimeType,parents)
Header:

Authorization: Bearer <ACCESS_TOKEN>
âš™ï¸ 3. Thá»±c hiá»‡n trong Power Automate Desktop
ThÃªm action Invoke Web Service (hoáº·c Web Request):

Method: GET

URL: (vÃ­ dá»¥ láº¥y trong má»™t folder)

https://www.googleapis.com/drive/v3/files?q='1FOLDER_ABC' in parents and trashed=false&driveId=0AAbCdEfGhIJkLmNOp&corpora=drive&includeItemsFromAllDrives=true&supportsAllDrives=true&fields=files(id,name,mimeType,parents)
Headers:

Authorization: Bearer %Access_Token%
Parse JSON Response
Response sáº½ cÃ³ dáº¡ng:

{
  "files": [
    {
      "id": "1x2y3zABC",
      "name": "Report.pdf",
      "mimeType": "application/pdf",
      "parents": ["1FOLDER_ABC"]
    },
    {
      "id": "4a5b6cDEF",
      "name": "Data.xlsx",
      "mimeType": "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
      "parents": ["1FOLDER_ABC"]
    }
  ]
}
DÃ¹ng action Convert JSON to custom object â†’ duyá»‡t files báº±ng For Each Ä‘á»ƒ láº¥y thÃ´ng tin.

ğŸ“Œ 4. LÆ°u Ã½
Náº¿u báº¡n khÃ´ng truyá»n q='<FolderID>' in parents â†’ API sáº½ tráº£ vá» toÃ n bá»™ file trong Shared Drive.

File vÃ  Folder trong Shared Drive Ä‘á»u lÃ  files, báº¡n phÃ¢n biá»‡t qua mimeType:

Folder: application/vnd.google-apps.folder

File: cÃ¡c loáº¡i mime khÃ¡c (pdf, docx, xlsxâ€¦)

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n máº«u flow PAD (gá»“m Invoke Web Service + Parse JSON + Loop) Ä‘á»ƒ báº¡n chá»‰ cáº§n thay Access Token, DriveID, FolderID lÃ  cháº¡y Ä‘Æ°á»£c khÃ´ng?

You said:
Giáº£i thÃ­ch cho tÃ´i chi tiáº¿t táº¡i sao trong URL láº¡i cÃ³ ?, and, &. 
Sá»­ dá»¥ng nÃ³ nhÆ° tháº¿ nÃ o, Ä‘Æ°a ra vÃ­ dá»¥
ChatGPT said:

Thought for 25s
Tuyá»‡t â€” mÃ¬nh giáº£i thÃ­ch rÃµ rÃ ng, ngáº¯n gá»n vÃ  cÃ³ vÃ­ dá»¥ cá»¥ thá»ƒ liÃªn quan tá»›i Google Drive API luÃ´n Ä‘á»ƒ báº¡n Ã¡p dá»¥ng vÃ o Power Automate Desktop (PAD).

1) Cáº¥u trÃºc cÆ¡ báº£n cá»§a má»™t URL
scheme://host/path?query#fragment
VÃ­ dá»¥:

https://api.example.com/search?q=cat&lang=vi#top
? báº¯t Ä‘áº§u query string (pháº§n tham sá»‘).

Query string gá»“m cÃ¡c cáº·p key=value.

CÃ¡c cáº·p Ä‘Æ°á»£c phÃ¢n tÃ¡ch báº±ng &.

#fragment lÃ  pháº§n tham chiáº¿u (khÃ´ng gá»­i tá»›i server).

2) Vai trÃ² cá»§a ?, &, =
? â€” chá»‰ ra chá»— báº¯t Ä‘áº§u danh sÃ¡ch tham sá»‘. Chá»‰ cÃ³ má»™t ? trong URL (pháº§n sau ? lÃ  query).

& â€” ngÄƒn cÃ¡ch hai tham sá»‘ (param) khÃ¡c nhau trong query string.

= â€” ná»‘i tÃªn tham sá»‘ vá»›i giÃ¡ trá»‹ cá»§a nÃ³ (key=value).

VÃ­ dá»¥:

https://example.com/search?query=cat&lang=vi
á» Ä‘Ã¢y cÃ³ 2 tham sá»‘: query=cat vÃ  lang=vi.

3) CÃ²n tá»« and á»Ÿ Ä‘Ã¢u ra?
and khÃ´ng pháº£i kÃ½ tá»± Ä‘iá»u khiá»ƒn URL â€” lÃ  má»™t chá»¯/ toÃ¡n tá»­ náº±m trong giÃ¡ trá»‹ cá»§a tham sá»‘ (value).

VÃ­ dá»¥ á»Ÿ Google Drive API: q nháº­n má»™t biá»ƒu thá»©c Ä‘iá»u kiá»‡n dáº¡ng SQL-like:
q = "'<FolderID>' in parents and trashed=false"
Náº¿u put trá»±c tiáº¿p vÃ o URL thÃ¬ and náº±m trong value cá»§a q, khÃ´ng pháº£i lÃ  kÃ½ hiá»‡u phÃ¢n tÃ¡ch tham sá»‘.

Quan trá»ng: vÃ¬ and cÃ¹ng vá»›i dáº¥u nhÃ¡y, dáº¥u cÃ¡ch, dáº¥u = lÃ  kÃ½ tá»± Ä‘áº·c biá»‡t trong URL nÃªn pháº£i mÃ£ hÃ³a (URL-encode) giÃ¡ trá»‹ trÆ°á»›c khi ghÃ©p vÃ o URL.

4) URL-encoding (percent-encoding) â€” vÃ¬ sao cáº§n?
Má»™t sá»‘ kÃ½ tá»± (space, quotes, &, ?, =, #, /, â€¦) cÃ³ nghÄ©a Ä‘áº·c biá»‡t trong URL. Náº¿u xuáº¥t hiá»‡n trong giÃ¡ trá»‹, pháº£i mÃ£ hÃ³a Ä‘á»ƒ server hiá»ƒu Ä‘Ãºng giÃ¡ trá»‹, trÃ¡nh bá»‹ nháº§m thÃ nh kÃ½ tá»± Ä‘iá»u khiá»ƒn.

Má»™t sá»‘ map phá»• biáº¿n:

space â†’ %20 (hoáº·c + trong application/x-www-form-urlencoded)

' â†’ %27

= â†’ %3D

& â†’ %26

( â†’ %28 , ) â†’ %29

, â†’ %2C

5) VÃ­ dá»¥ thá»±c táº¿ (Google Drive Shared Drive, cÃ³ and trong q)
Giáº£ sá»­:

FolderID = 1FOLDER_ABC

DriveID = 0AAbCdEfGhIJkLmNOp

Raw (chÆ°a encode) dá»… Ä‘á»c:

https://www.googleapis.com/drive/v3/files?
q='1FOLDER_ABC' in parents and trashed=false
&driveId=0AAbCdEfGhIJkLmNOp
&corpora=drive
&includeItemsFromAllDrives=true
&supportsAllDrives=true
&fields=files(id,name,mimeType)
Pháº£i encode pháº§n q vÃ  fields trÆ°á»›c khi láº¯p vÃ o URL. Má»™t phiÃªn báº£n Ä‘Ã£ encode:

GET https://www.googleapis.com/drive/v3/files?
q=%271FOLDER_ABC%27%20in%20parents%20and%20trashed%3Dfalse
&driveId=0AAbCdEfGhIJkLmNOp
&corpora=drive
&includeItemsFromAllDrives=true
&supportsAllDrives=true
&fields=files%28id%2Cname%2CmimeType%29
Gá»™p láº¡i thÃ nh 1 dÃ²ng (copy-paste Ä‘Æ°á»£c):

https://www.googleapis.com/drive/v3/files?q=%271FOLDER_ABC%27%20in%20parents%20and%20trashed%3Dfalse&driveId=0AAbCdEfGhIJkLmNOp&corpora=drive&includeItemsFromAllDrives=true&supportsAllDrives=true&fields=files%28id%2Cname%2CmimeType%29
Giáº£i thÃ­ch:

%27 = ' (single quote)

%20 = space

%3D = =

%28/%29/%2C = ( / ) / , trong fields

6) Má»™t vÃ­ dá»¥ Ä‘Æ¡n giáº£n khÃ¡c (web search)
Raw:

https://example.com/search?q=cat videos&lang=vi
Encode q:

https://example.com/search?q=cat%20videos&lang=vi
7) LÆ°u Ã½ thá»±c táº¿ khi lÃ m vá»›i PAD / HTTP requests
LuÃ´n URL-encode báº¥t ká»³ giÃ¡ trá»‹ nÃ o cÃ³ dáº¥u cÃ¡ch, kÃ½ tá»± Ä‘áº·c biá»‡t (nhÆ° q chá»©a and, ', =...). Náº¿u khÃ´ng, server sáº½ hiá»ƒu sai (vÃ­ dá»¥ & trong value sáº½ bá»‹ coi lÃ  tham sá»‘ má»›i).

? chá»‰ dÃ¹ng má»™t láº§n; cÃ¡c tham sá»‘ tiáº¿p theo ná»‘i báº±ng &.

Thá»© tá»± cÃ¡c tham sá»‘ khÃ´ng quan trá»ng (server thÆ°á»ng xá»­ lÃ½ theo tÃªn param).

DÃ¹ng hÃ m encodeURIComponent() (JS) hoáº·c hÃ m URL encode trong ngÃ´n ngá»¯ báº¡n dÃ¹ng Ä‘á»ƒ táº¡o URL. Trong PAD, náº¿u khÃ´ng cÃ³ action encode sáºµn, dÃ¹ng biáº¿n vÃ  gá»i API encode hoáº·c build thá»§ cÃ´ng (cáº©n tháº­n).

8) Cheat-sheet ngáº¯n
DÃ¹ng ? Ä‘á»ƒ báº¯t Ä‘áº§u pháº§n tham sá»‘.

DÃ¹ng & Ä‘á»ƒ ná»‘i nhiá»u tham sá»‘.

DÃ¹ng = Ä‘á»ƒ gÃ¡n key=value.

Náº¿u value chá»©a and, space, ', &, =, â€¦ â†’ URL-encode value Ä‘Ã³.

Náº¿u cáº§n truyá»n cÃ¢u lá»‡nh Ä‘iá»u kiá»‡n (nhÆ° q cá»§a Drive) â€” nhá»› encode toÃ n bá»™ biá»ƒu thá»©c.

Muá»‘n mÃ¬nh táº¡o giÃºp URL Ä‘Ã£ encode sáºµn cho request cá»§a báº¡n (vÃ­ dá»¥ báº¡n Ä‘Æ°a FolderID vÃ  DriveID), hoáº·c máº«u dÃ²ng PAD (Invoke Web Request) Ä‘á»ƒ copy-paste â€” gá»­i mÃ¬nh hai ID Ä‘Ã³ lÃ  mÃ¬nh build luÃ´n cho báº¡n.

You said:
VÃ­ dá»¥, Toi cÃ³ Folder Id = 133222, Folder Name  = XXXX thuá»™c Folder ID, 
TÃ”i muá»‘n get list files vÃ  folder trong Folder Name = XXXX. HÃ£y viáº¿t cho tÃ´i xá»­ lÃ½ nÃ y báº±ng Power Automate Desktop HTTP
ChatGPT said:
RÃµ rá»“i ğŸ‘ báº¡n cÃ³:

Folder cha cÃ³ ID = 133222

Trong Ä‘Ã³ cÃ³ má»™t Folder con tÃªn = XXXX

Báº¡n muá»‘n dÃ¹ng Power Automate Desktop (PAD) vá»›i action Invoke Web Service (HTTP) Ä‘á»ƒ láº¥y list file & folder bÃªn trong Folder con XXXX.

MÃ¬nh sáº½ hÆ°á»›ng dáº«n thÃ nh 2 bÆ°á»›c trong PAD:

ğŸ”‘ Ã tÆ°á»Ÿng
TÃ¬m Folder con XXXX trong Folder cha 133222 (láº¥y ID tháº­t cá»§a XXXX).

VÃ¬ Google Drive API chá»‰ query theo Folder ID, khÃ´ng query trá»±c tiáº¿p theo tÃªn.

List file & folder trong Folder XXXX báº±ng ID láº¥y Ä‘Æ°á»£c á»Ÿ bÆ°á»›c 1.

âš™ï¸ 1. TÃ¬m Folder XXXX trong Folder cha 133222
API:

GET https://www.googleapis.com/drive/v3/files?q='133222' in parents and mimeType='application/vnd.google-apps.folder' and name='XXXX' and trashed=false&supportsAllDrives=true&includeItemsFromAllDrives=true&fields=files(id,name)
Trong PAD (Invoke Web Service):

Method: GET

URL:

https://www.googleapis.com/drive/v3/files?q=%27133222%27%20in%20parents%20and%20mimeType%3D%27application%2Fvnd.google-apps.folder%27%20and%20name%3D%27XXXX%27%20and%20trashed%3Dfalse&supportsAllDrives=true&includeItemsFromAllDrives=true&fields=files%28id%2Cname%29
Headers:

Authorization: Bearer %Access_Token%
Response vÃ­ dá»¥:

{
  "files": [
    { "id": "1FOLDERXXXX", "name": "XXXX" }
  ]
}
ğŸ‘‰ Láº¥y id = 1FOLDERXXXX Ä‘á»ƒ dÃ¹ng á»Ÿ bÆ°á»›c 2.

âš™ï¸ 2. Láº¥y file & folder trong Folder XXXX
API:

GET https://www.googleapis.com/drive/v3/files?q='1FOLDERXXXX' in parents and trashed=false&supportsAllDrives=true&includeItemsFromAllDrives=true&fields=files(id,name,mimeType)
Trong PAD (Invoke Web Service):

Method: GET

URL:

https://www.googleapis.com/drive/v3/files?q=%271FOLDERXXXX%27%20in%20parents%20and%20trashed%3Dfalse&supportsAllDrives=true&includeItemsFromAllDrives=true&fields=files%28id%2Cname%2CmimeType%29
Headers:

Authorization: Bearer %Access_Token%
Response vÃ­ dá»¥:

{
  "files": [
    { "id": "1ABC", "name": "Document1.pdf", "mimeType": "application/pdf" },
    { "id": "2DEF", "name": "SubFolder", "mimeType": "application/vnd.google-apps.folder" }
  ]
}
ğŸ‘‰ mimeType cho biáº¿t Ä‘Ã³ lÃ  file hay folder.

ğŸ“Œ Trong PAD báº¡n lÃ m Flow nhÆ° sau:
Action Invoke Web Service (GET #1) â†’ tÃ¬m Folder ID cá»§a XXXX.

Action Convert JSON to custom object â†’ láº¥y id cá»§a folder XXXX.

Action Invoke Web Service (GET #2) â†’ láº¥y danh sÃ¡ch file/folder bÃªn trong XXXX.

Action Convert JSON to custom object â†’ For Each qua files Ä‘á»ƒ xá»­ lÃ½.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n flow máº«u PAD dáº¡ng pseudocode (tÃªn action + input + output) Ä‘á»ƒ báº¡n copy-paste tá»«ng bÆ°á»›c vÃ o PAD khÃ´ng?

You said:
Chá»• bÆ°á»›c 1 náº¿u khÃ´ng set MimeType cÃ³ Ä‘Æ°á»£c khÃ´ng?
ChatGPT said:
Chuáº©n cÃ¢u há»i hay ğŸ‘Œ

ğŸ” Tráº£ lá»i ngáº¯n gá»n
KhÃ´ng báº¯t buá»™c pháº£i set mimeType khi query.

NhÆ°ng náº¿u khÃ´ng set, káº¿t quáº£ sáº½ tráº£ vá» táº¥t cáº£ file + folder cÃ³ name = 'XXXX' trong parent 133222.

Náº¿u trong folder cha cÃ³ file trÃ¹ng tÃªn "XXXX" thÃ¬ báº¡n sáº½ láº¥y nháº§m.

ğŸ“ Chi tiáº¿t
Náº¿u cÃ³ mimeType='application/vnd.google-apps.folder'
Query:

q='133222' in parents and mimeType='application/vnd.google-apps.folder' and name='XXXX' and trashed=false
ğŸ‘‰ Chá»‰ tráº£ vá» folder Ä‘Ãºng tÃªn XXXX.

Náº¿u khÃ´ng cÃ³ mimeType
Query:

q='133222' in parents and name='XXXX' and trashed=false
ğŸ‘‰ CÃ³ thá»ƒ tráº£ vá»:

{
  "files": [
    { "id": "1FOLDERXXXX", "name": "XXXX", "mimeType": "application/vnd.google-apps.folder" },
    { "id": "2FILEXXXX", "name": "XXXX", "mimeType": "application/pdf" }
  ]
}
Báº¡n sáº½ pháº£i kiá»ƒm tra thÃªm trong code PAD:

Náº¿u mimeType = application/vnd.google-apps.folder â†’ Ä‘Ã³ lÃ  folder báº¡n cáº§n.

Náº¿u khÃ´ng â†’ bá» qua.

ğŸ“Œ Káº¿t luáº­n
Náº¿u báº¡n cháº¯c cháº¯n "XXXX" luÃ´n lÃ  folder duy nháº¥t â†’ khÃ´ng set mimeType cÅ©ng Ä‘Æ°á»£c.

Náº¿u cáº©n tháº­n, trÃ¡nh nháº§m file cÃ¹ng tÃªn â†’ nÃªn set mimeType='application/vnd.google-apps.folder'.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n Ä‘oáº¡n logic For Each trong PAD Ä‘á»ƒ lá»c mimeType=folder náº¿u báº¡n quyáº¿t Ä‘á»‹nh khÃ´ng dÃ¹ng filter mimeType trong query khÃ´ng?






KhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»nKhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»n
ChatGPT can make mistakes. Check important info.
