Skip to content
Chat history

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ get list file in folder Gdrive báº±ng API power automate desktop
ChatGPT said:
Báº¡n muá»‘n láº¥y danh sÃ¡ch file trong 1 folder cá»§a Google Drive báº±ng Power Automate Desktop (PAD) thÃ´ng qua Google Drive API Ä‘Ãºng khÃ´ng? ğŸ‘

MÃ¬nh hÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c nhÃ©:

ğŸ”‘ 1. Chuáº©n bá»‹ trÆ°á»›c
Báº¡n cáº§n Access Token (tá»« OAuth2 hoáº·c Service Account) vá»›i scope:

https://www.googleapis.com/auth/drive
LÆ°u Folder ID cá»§a thÆ° má»¥c báº¡n muá»‘n láº¥y file.
VÃ­ dá»¥ URL folder:

https://drive.google.com/drive/folders/1ABCDefGHIJKLmnop
ğŸ‘‰ Folder ID = 1ABCDefGHIJKLmnop

ğŸ“¡ 2. API Google Drive Ä‘á»ƒ láº¥y danh sÃ¡ch file
Endpoint:

GET https://www.googleapis.com/drive/v3/files
Query Ä‘á»ƒ lá»c theo folder:

?q='<FolderID>' in parents and trashed=false
VÃ­ dá»¥ Ä‘áº§y Ä‘á»§:

GET https://www.googleapis.com/drive/v3/files?q='1ABCDefGHIJKLmnop' in parents and trashed=false&fields=files(id,name,mimeType)
Header:

{
  "Authorization": "Bearer <ACCESS_TOKEN>"
}
âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service (hoáº·c Invoke Web Request).

Method: GET

URL:

https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&fields=files(id,name,mimeType)
Headers:

Authorization: Bearer %Access_Token%
Nháº­n Response JSON â†’ parse ra danh sÃ¡ch file:
VÃ­ dá»¥ response:

{
  "files": [
    { "id": "1x2y3z", "name": "file1.pdf", "mimeType": "application/pdf" },
    { "id": "4a5b6c", "name": "file2.docx", "mimeType": "application/vnd.openxmlformats-officedocument.wordprocessingml.document" }
  ]
}
Parse JSON trong PAD:

DÃ¹ng action: Convert JSON to custom object

Sau Ä‘Ã³ cÃ³ thá»ƒ For Each Ä‘á»ƒ duyá»‡t danh sÃ¡ch file.

ğŸ“Œ 4. Láº¥y cáº£ subfolder?
API máº·c Ä‘á»‹nh chá»‰ tráº£ file trong folder trá»±c tiáº¿p.

Náº¿u muá»‘n láº¥y táº¥t cáº£ subfolder + file bÃªn trong â†’ báº¡n pháº£i cháº¡y Ä‘á»‡ quy:

Gá»i API láº¥y list files cÃ³ mimeType = 'application/vnd.google-apps.folder'.

Sau Ä‘Ã³ láº·p qua tá»«ng folder con Ä‘á»ƒ gá»i láº¡i API.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t máº«u flow PAD (gá»“m HTTP request + Parse JSON + Loop) Ä‘á»ƒ láº¥y danh sÃ¡ch file trong folder khÃ´ng?

You said:
LÃ m tháº¿ nÃ o Ä‘á»ƒ move file hoáº·c folder trong Gdrive báº±ng power automate desktop
ChatGPT said:
Äá»ƒ move file hoáº·c folder trong Google Drive báº±ng Power Automate Desktop (PAD) thÃ¬ báº¡n sáº½ thao tÃ¡c vá»›i Google Drive API. Báº£n cháº¥t â€œmoveâ€ trong GDrive lÃ  thay Ä‘á»•i parents cá»§a file/folder (remove old parent, add new parent).

ğŸ”‘ 1. Chuáº©n bá»‹
Access Token (OAuth2) vá»›i scope:

https://www.googleapis.com/auth/drive
ID cá»§a file/folder cáº§n move (vÃ­ dá»¥: 1ABCxyz...).

ID cá»§a folder Ä‘Ã­ch (vÃ­ dá»¥: 1Target123...).

ID cá»§a folder gá»‘c (old parent) náº¿u báº¡n muá»‘n bá» nÃ³ khá»i thÆ° má»¥c cÅ©.

ğŸ“¡ 2. API Move file/folder
Google Drive API endpoint:

PATCH https://www.googleapis.com/drive/v3/files/{fileId}?addParents={newParentId}&removeParents={oldParentId}&fields=id,parents
VÃ­ dá»¥
Move file 1ABCxyz tá»« folder 1OLD111 sang folder 1NEW222:

PATCH https://www.googleapis.com/drive/v3/files/1ABCxyz?addParents=1NEW222&removeParents=1OLD111&fields=id,parents
Header:

Authorization: Bearer <ACCESS_TOKEN>
Content-Type: application/json
Body: (cÃ³ thá»ƒ Ä‘á»ƒ trá»‘ng vÃ¬ chá»‰ cáº§n query params)

âš™ï¸ 3. Triá»ƒn khai trong Power Automate Desktop
DÃ¹ng action: Invoke Web Service

Method: PATCH

URL:

https://www.googleapis.com/drive/v3/files/%FileID%?addParents=%NewFolderID%&removeParents=%OldFolderID%&fields=id,parents
Headers:

Authorization: Bearer %Access_Token%
Content-Type: application/json
Body: {} (hoáº·c Ä‘á»ƒ trá»‘ng)

Xá»­ lÃ½ Response

Náº¿u thÃ nh cÃ´ng, JSON tráº£ vá» sáº½ chá»©a id vÃ  parents má»›i.

Báº¡n cÃ³ thá»ƒ dÃ¹ng Convert JSON to custom object Ä‘á»ƒ parse.

ğŸ“Œ 4. Move Folder
Google Drive treats folders cÅ©ng nhÆ° file (mimeType = application/vnd.google-apps.folder).

VÃ¬ váº­y move folder cÅ©ng dÃ¹ng API trÃªn giá»‘ng há»‡t nhÆ° move file. âœ…

ğŸ” 5. LÆ°u Ã½
Náº¿u báº¡n khÃ´ng truyá»n removeParents, file sáº½ náº±m á»Ÿ cáº£ hai folder (Google Drive cho phÃ©p 1 file cÃ³ nhiá»u parents).

Náº¿u muá»‘n chá»‰ á»Ÿ 1 folder duy nháº¥t â†’ luÃ´n truyá»n cáº£ addParents vÃ  removeParents.

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n máº«u action trong PAD (Invoke Web Service) Ä‘á»ƒ báº¡n copy-paste vÃ o flow, chá»‰ cáº§n thay ID vÃ  Token khÃ´ng?






KhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»nKhÃ´ng cÃ³ tá»‡p nÃ o Ä‘Æ°á»£c chá»n
ChatGPT can make mistakes. Check important info.


GET https://www.googleapis.com/drive/v3/files?q='<FolderID>' in parents and trashed=false&driveId=<DriveID>&corpora=drive&includeItemsFromAllDrives=true&supportsAllDrives=true&fields=files(id,name,mimeType,parents)
